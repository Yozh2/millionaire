/* ============================================
   CampaignCard styles + animations
   ============================================ */

@property --campaign-z {
  syntax: '<length>';
  inherits: true;
  initial-value: 0px;
}

@property --campaign-focusScale {
  syntax: '<number>';
  inherits: true;
  initial-value: 1;
}

@keyframes campaign-card-appear {
  0% {
    opacity: 0;
    filter: blur(2px);
  }
  100% {
    opacity: 1;
    filter: blur(0);
  }
}

@keyframes campaign-glow-breathe {
  0% {
    opacity: 0.35;
    transform: scale(0.98);
  }
  50% {
    opacity: 0.65;
    transform: scale(1.04);
  }
  100% {
    opacity: 0.35;
    transform: scale(0.98);
  }
}

@keyframes campaign-rays-rotate {
  0% {
    transform: rotate(0deg) scaleX(var(--ray-scale-x, 1)) scaleY(var(--ray-scale-y, 1));
  }
  100% {
    transform: rotate(360deg) scaleX(var(--ray-scale-x, 1)) scaleY(var(--ray-scale-y, 1));
  }
}

@keyframes campaign-rays-rotate-reverse {
  0% {
    transform: rotate(360deg) scaleX(var(--ray-scale-x, 1)) scaleY(var(--ray-scale-y, 1));
  }
  100% {
    transform: rotate(0deg) scaleX(var(--ray-scale-x, 1)) scaleY(var(--ray-scale-y, 1));
  }
}

@keyframes campaign-rays-pulse {
  0%,
  100% {
    opacity: 0.12;
  }
  40% {
    opacity: 0.38;
  }
  70% {
    opacity: 0.18;
  }
}

@keyframes campaign-rays-shimmer {
  0%,
  100% {
    opacity: 0.22;
    filter: blur(0.9px);
  }
  40% {
    opacity: 0.5;
    filter: blur(0.7px);
  }
  70% {
    opacity: 0.3;
    filter: blur(1.2px);
  }
}

.engine .campaign-card {
  --campaign-mainY: 0px;
  --campaign-bobY: 0px;
  --campaign-pressY: 0px;
  --campaign-shiftX: 0px;
  --campaign-z: 0px;
  --campaign-rx: 0deg;
  --campaign-ry: 0deg;
  --campaign-scale: 1;
  --campaign-focusScale: 1;
  --campaign-glare: 0;
  --campaign-glareX: 0px;
  --campaign-glareY: 0px;
  --campaign-icon-shift-x: 0px;
  --campaign-icon-shift-y: 0px;
  --campaign-icon-z: 24px;
  --campaign-icon-shadow-x: 2px;
  --campaign-icon-shadow-y: 2px;
  --campaign-icon-shadow-blur: 10px;
  --campaign-icon-shadow-opacity: 0.6;

  transform: perspective(900px)
    translateX(var(--campaign-shiftX))
    translateY(calc(var(--campaign-mainY) + var(--campaign-bobY) + var(--campaign-pressY)))
    translateZ(var(--campaign-z))
    rotateX(var(--campaign-rx))
    rotateY(var(--campaign-ry))
    scale(calc(var(--campaign-scale) * var(--campaign-focusScale)));
  transform-style: preserve-3d;
  transform-origin: center center;
  transition:
    box-shadow 220ms cubic-bezier(0.22, 1, 0.36, 1),
    --campaign-z 520ms cubic-bezier(0.16, 1, 0.3, 1),
    --campaign-focusScale 620ms cubic-bezier(0.16, 1, 0.3, 1);
  will-change: transform;
  cursor: pointer;
}

.engine .campaign-card[data-selected='true'] {
  z-index: 30;
}

.engine [data-campaign-row-scaled='true'] .campaign-card[data-selected='true'] {
  z-index: 60;
}

.engine .campaign-card[data-card-state='Appear'] {
  animation: campaign-card-appear 240ms cubic-bezier(0.22, 1, 0.36, 1) both;
}

.engine .campaign-card[data-card-state='Hover'] {
  --campaign-scale: 1.015;
}

.engine .campaign-card[data-card-state='Press'] {
  --campaign-pressY: 4px;
  --campaign-scale: 0.99;
}

.engine .campaign-card[data-card-state='Ease'] {
  --campaign-pressY: 0px;
  --campaign-scale: 1;
}

.engine .campaign-card[data-card-state='Activate'] {
  cursor: default;
  --campaign-scale: 1;
  --campaign-pressY: 0px;
}

.engine .campaign-card[data-card-state='Deactivate'] {
  --campaign-scale: 1;
  --campaign-pressY: 0px;
}

.engine .campaign-card-glare {
  inset: -40%;
  background: linear-gradient(
    135deg,
    rgba(255, 255, 255, 0) 0%,
    rgba(255, 255, 255, 0) 26%,
    rgba(255, 255, 255, 0.55) 38%,
    rgba(255, 255, 255, 0.2) 48%,
    rgba(255, 255, 255, 0) 60%,
    rgba(255, 255, 255, 0) 100%
  );
  transform: translate(var(--campaign-glareX), var(--campaign-glareY))
    translateZ(36px);
  opacity: calc(var(--campaign-glare) * 0.85);
  mix-blend-mode: screen;
  filter: blur(0.2px);
  z-index: 50;
}

.engine .campaign-icon-glow {
  position: absolute;
  inset: -60%;
  border-radius: 9999px;
  background: radial-gradient(
    circle at 50% 55%,
    color-mix(in srgb, var(--campaign-glow, rgba(255, 200, 0, 0.65)) 55%, transparent) 0%,
    color-mix(in srgb, var(--campaign-glow, rgba(255, 200, 0, 0.65)) 25%, transparent) 38%,
    color-mix(in srgb, var(--campaign-glow-secondary, rgba(255, 255, 255, 0.35)) 22%, transparent) 60%,
    transparent 78%
  );
  filter: blur(9px);
  opacity: 0;
  transform: scale(0.12);
  transform-origin: 50% 55%;
  transition:
    opacity 260ms ease-out,
    transform 520ms cubic-bezier(0.22, 1, 0.36, 1);
  animation: campaign-glow-breathe 2.6s ease-in-out infinite;
  animation-play-state: paused;
  z-index: 0;
}

.engine .campaign-icon-glow::before {
  content: '';
  position: absolute;
  inset: -12%;
  border-radius: 9999px;
  background: radial-gradient(
    circle at 50% 52%,
    color-mix(in srgb, var(--campaign-glow, rgba(255, 200, 0, 0.65)) 55%, transparent) 0%,
    color-mix(in srgb, var(--campaign-glow, rgba(255, 200, 0, 0.65)) 18%, transparent) 45%,
    transparent 72%
  );
  filter: blur(5px);
  opacity: 0.75;
}

.engine .campaign-icon-rays-wrap {
  position: absolute;
  inset: -86%;
  border-radius: 9999px;
  opacity: 0;
  transform: scale(0.12);
  transform-origin: 50% 50%;
  transition:
    opacity 260ms ease-out,
    transform 640ms cubic-bezier(0.22, 1, 0.36, 1);
  will-change: transform, opacity;
  pointer-events: none;
  z-index: 0;
}

.engine .campaign-icon-rays {
  position: absolute;
  inset: 0;
  border-radius: 9999px;
  --ray-scale-x: 1;
  --ray-scale-y: 1;
  background:
    repeating-conic-gradient(
      from 12deg,
      transparent 0deg 16deg,
      color-mix(in srgb, var(--campaign-glow, rgba(255, 200, 0, 0.65)) 55%, transparent) 16deg 20deg,
      transparent 20deg 44deg
    );
  mask-image: radial-gradient(circle at 50% 50%, transparent 0% 26%, black 46%, transparent 76%);
  mix-blend-mode: screen;
  filter: blur(0.9px);
  opacity: 1;
  animation:
    campaign-rays-rotate 18s linear infinite,
    campaign-rays-pulse 2.1s ease-in-out infinite;
  animation-play-state: paused;
}

.engine .campaign-icon-rays::before,
.engine .campaign-icon-rays::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 9999px;
  mix-blend-mode: screen;
  pointer-events: none;
}

.engine .campaign-icon-rays::before {
  background:
    repeating-conic-gradient(
      from 220deg,
      transparent 0deg 10deg,
      color-mix(in srgb, var(--campaign-glow, rgba(255, 200, 0, 0.65)) 45%, transparent) 10deg 14deg,
      transparent 14deg 38deg
    );
  mask-image: radial-gradient(circle at 50% 50%, transparent 0% 30%, black 50%, transparent 82%);
  filter: blur(0.75px);
  opacity: 0.75;
  --ray-scale-x: 1.04;
  --ray-scale-y: 0.94;
  animation: campaign-rays-rotate 9.6s linear infinite;
  animation-play-state: paused;
}

.engine .campaign-icon-rays::after {
  background:
    repeating-conic-gradient(
      from 40deg,
      transparent 0deg 22deg,
      color-mix(in srgb, var(--campaign-glow-secondary, rgba(255, 255, 255, 0.35)) 55%, transparent) 22deg 26deg,
      transparent 26deg 52deg
    );
  mask-image: radial-gradient(circle at 50% 50%, transparent 0% 34%, black 56%, transparent 86%);
  opacity: 0.6;
  --ray-scale-x: 0.96;
  --ray-scale-y: 1.06;
  animation:
    campaign-rays-rotate-reverse 13.4s linear infinite,
    campaign-rays-shimmer 2.7s ease-in-out infinite;
  animation-play-state: paused;
}

.engine .campaign-icon-parallax {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  transform-style: preserve-3d;
  transform: translate3d(
      var(--campaign-icon-shift-x),
      var(--campaign-icon-shift-y),
      var(--campaign-icon-z)
    );
  transition: transform 140ms cubic-bezier(0.22, 1, 0.36, 1);
  will-change: transform;
  pointer-events: none;
  z-index: 3;
}

.engine .campaign-icon-img {
  transform: translateZ(calc(var(--campaign-icon-z) * 0.6));
  filter: drop-shadow(
    var(--campaign-icon-shadow-x)
      var(--campaign-icon-shadow-y)
      var(--campaign-icon-shadow-blur)
      rgba(0, 0, 0, var(--campaign-icon-shadow-opacity))
  );
}

.engine .campaign-card[data-selected='true'] .campaign-icon-glow,
.engine .campaign-card[data-selected='true'] .campaign-icon-rays-wrap {
  opacity: 1;
  transform: scale(1);
  animation-play-state: running;
}

.engine .campaign-card[data-selected='true'] .campaign-icon-rays {
  animation-play-state: running;
}

.engine .campaign-card[data-selected='true'] .campaign-icon-rays-wrap {
  transition-delay: 90ms;
}

.engine .campaign-card[data-selected='true'] .campaign-icon-rays::before,
.engine .campaign-card[data-selected='true'] .campaign-icon-rays::after {
  animation-play-state: running;
}

@media (prefers-reduced-motion: reduce) {
  .engine .campaign-card[data-card-state='Activate'],
  .engine .campaign-card[data-card-state='Deactivate'],
  .engine .campaign-card[data-card-state='Appear'],
  .engine .campaign-card[data-card-state='Disappear'] {
    animation: none !important;
  }
  .engine .campaign-icon-glow,
  .engine .campaign-icon-rays-wrap,
  .engine .campaign-icon-rays,
  .engine .campaign-icon-rays::before,
  .engine .campaign-icon-rays::after {
    animation: none !important;
  }
}
